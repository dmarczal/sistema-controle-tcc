<div>
    <legend>Entrega de documentos</legend>
    <h3>Gostaria de entregar o seguinte documento:</h3>
    <form method="POST" enctype="multipart/form-data" action="<%= student_delivery_item_path(@item_timeline.id) %>">
        <table class="table table-bordered">
            <tr>
                <td>Documento:</td>
                <td><%= @item_base.title %></td>
            </tr>
            <tr>
                <td>Descrição:</td>
                <td><%= @item_base.description %></td>
            </tr>
            <tr>
                <td>Importar do dropbox:</td>
                <td id="dropbox-append">
                    <br>
                    <% if @item_timeline.dropbox_file? %>
                        <%= link_to @item_timeline.dropbox_file, @item_timeline.dropbox_file, target: '_blank' %>
                    <% end %>
                </td>
            </tr>
            <%= hidden_field :item, :dropbox_file %>
            <% if false %>
            <tr>
                <td>Anexo: (só são aceitos arquivos .pdf e .jpg)</td>
                <td>
                    <%= file_field :item, :file, class: 'form-control', accept: 'application/pdf,/image/png,image/gif,image/jpeg' %>
                    <br>
                    <% if @item_timeline.file? %>
                        <%= link_to @item_timeline.file_file_name, @item_timeline.file.url, target: '_blank' %>
                    <% end %>
                </td>
            </tr>
            <% end %>
        </table>
        <!-- Button (Double) -->
        <div class="form-group">
          <label class="col-md-4 control-label" for="save"></label>
          <div class="col-md-4 col-md-offset-1">
            <button id="save" name="save" type="submit" class="btn btn-primary">Enviar</button>
          </div>
        </div>
    </form>
</div>
<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="s883kb109o767em"></script>
<script>
    options = {

        // Required. Called when a user selects an item in the Chooser.
        success: function(files) {
            $('#item_dropbox_file').val(files[0].link);
        },

        // Optional. Called when the user closes the dialog without selecting a file
        // and does not include any parameters.
        cancel: function() {

        },

        // Optional. "preview" (default) is a preview link to the document for sharing,
        // "direct" is an expiring link to download the contents of the file. For more
        // information about link types, see Link types below.
        linkType: "direct", // or "direct"

        // Optional. A value of false (default) limits selection to a single file, while
        // true enables multiple file selection.
        multiselect: false, // or true

        // Optional. This is a list of file extensions. If specified, the user will
        // only be able to select files with these extensions. You may also specify
        // file types, such as "video" or "images" in the list. For more information,
        // see File types below. By default, all extensions are allowed.
        extensions: ['.pdf', '.doc', '.docx'],
    };
    var button = Dropbox.createChooseButton(options);
    $("#dropbox-append").prepend(button);
</script>